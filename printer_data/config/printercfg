
2️⃣ Klipper Configuration (printer.cfg)
# NeoPixel configuration
[neopixel bed_lights]
pin: PA8                # Change to your MCU pin
chain_count: 8          # Number of LEDs in your stick
color_order: GBRW       # Most WS2812 use GRB
initial_RED: 0.0
initial_GREEN: 0.0
initial_BLUE: 0.0
initial_WHITE: 0.0
3️⃣ Custom G-code Macros
# Set LEDs to a solid color
[gcode_macro LED_SOLID]
description: Set NeoPixel stick to a solid RGB color
# Usage: LED_SOLID R=1.0 G=0.0 B=0.0  (full red)
variable_r: 0.0
variable_g: 0.0
variable_b: 0.0
variable_w: 0.0
gcode:
    SET_LED LED=bed_lights RED={R} GREEN={G} BLUE={B} WHITE={W}

# Turn LEDs off
[gcode_macro LED_OFF]
description: Turn off all NeoPixels
gcode:
    SET_LED LED=bed_lights RED=0 GREEN=0 BLUE=0 WHITE=0

# Example: Print progress color change
[gcode_macro PRINT_PROGRESS_LEDS]
description: Change LED color based on print progress
gcode:
    {% set progress = printer.print_stats.progress %}
    {% if progress < 0.33 %}
        SET_LED LED=bed_lights RED=0 GREEN=0 BLUE=1.0 WHITE=0
    {% elif progress < 0.66 %}
        SET_LED LED=bed_lights RED=1.0 GREEN=1.0 BLUE=0 WHITE=0
    {% else %}
        SET_LED LED=bed_lights RED=0 GREEN=1.0 BLUE=0 WHITE=0
    {% endif %}

4️⃣ Example Usage in G-code
LED_SOLID R=1.0 G=0.0 B=0.0 W=0.0 ; Red
LED_SOLID R=0.0 G=1.0 B=0.0 W=0.0  ; Green
LED_OFF                        ; Turn off LEDs

5️⃣ Notes
Brightness control: You can add WHITE or scale RGB values (0.0–1.0) for dimming.
Animations: Klipper’s SET_LED is static — for effects like rainbow or breathing, you’d need to:
Use led_effect module in Klipper (if enabled in your build)